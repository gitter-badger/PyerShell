# 1. The Demo

## Overview

This proposal focus on the ideology and the core functionalities of `PyerShell` (which is not implemented...)

## Ideology

`PyerShell` is inspired from [PowerShell](https://github.com/PowerShell/PowerShell),
aiming to bring strong type to the world of shell with the power of python.

### Development

PyerShell development follows the following ideology:
- Open Source can benefit both the user, the developer and the contributor.
- Code without test is not good code.
- Detail documentation is helpful to everyone.
- Typing helps us code, therefore type hinting is **required** unless it is too complicated.

### Software Name 

`PyerShell` can be interpreted in the following 2 ways:
- Make your shell more python like.
- A name derived from PowerShell.

## Core Functionalities

### Usage

`PyerShell` enables you get the full power of python, with the syntax of shell.

For example, you will be able to call python function in the following ways:

#### Uses Shell Syntax

for a function:

```python
def foo(first: str, second: int) -> str :
    return first + " " + str(second)
```

you can call it via:
``` bash
> foo --first "hello" --second 0
"hello 0"
```
or uses the positional parameter:
```bash
> foo "hello" 0
"hello 0"
```

#### Uses Python 

you can directly call python statement in `PyerShell`:
```python
> [foo("hello", i) for i in range(2)] 

["hello 0", "hello 1"]
```

#### Embed Python Syntax in Shell Syntax

you can directly embed python syntax in shell syntax with out any moderation

```bash
> foo --first "hello" --second range(2)[1]
"hello 1"
```

#### Embed Shell Syntax in Python

you can embed the shell syntax in python with `$( <shell_syntax> )`:

```python
> [$( foo --first "hello" --second i) for i in range(2)] 
["hello 0", "hello 1"]
```

### PipLine

function's pipline parameter will be registered with the following command:
```python
add_pipline(command_name="foo", pipline_para_name="second")
```

you can send strong typed object through a pipline.
```bash
> 1 + 2 | foo --first "hello"
"hello 3"
```

you can also use `$_` as the value that is piped to this statement:
```python
> from pathlib import Path
> ls | [x for x in $_ if x.is_dir()]
[WindowsPath('.git'), WindowsPath('proposals')]
```

### Configuration

there will be config folder `~/.pyer_profile/`, which stores all your modules and your personal config file.

your config file and the modules will be writen in python. 

the file will have full intellisense when you edit it. (assuming your editor support python intellisense)


### Completion

Completion will be handled by [python-prompt-toolkit](https://github.com/jonathanslenders/python-prompt-toolkit)

#### Python 

We will first compile your console style syntax to python syntax,
then get the word to complete by give the python syntax to default completer,
get the output and return that.

See the IMPLEMENTATION for more detail

#### Executable

As a shell we have to be able to run Executable. 

The completion will be generated by `man` command on unix style system

it requires some work on Windows...

#### Custom

you can register a custom command completer with the following command

```python
add_command_completer(command="git commit", parameter_short_name="m", parameter_long_name="message",completer_function=test_function)
```
the `completer_function` need to take nothing and return a list of string that are suitable to be the value of this parameter

you will also be able to add completer via man page. (assume you save the man page content into `git-man.txt`)

```python
git_man_content = get_file_content("git-man.txt")
add_command_completer_via_man(man_page_content=git_man_content)
```

### Syntax Highlighting

the lexer of `PyerShell` will be combination of the following lexer:

- [BashLexer](http://pygments.org/docs/lexers/#pygments.lexers.shell.BashLexer)  (*nix only)
- [BatchLexer](http://pygments.org/docs/lexers/#pygments.lexers.shell.BatchLexer)  (Windows only)
- [PythonConsoleLexer](http://pygments.org/docs/lexers/#pygments.lexers.python.PythonConsoleLexer) 
- Custom lexer for console syntax of python code

### History and Auto Suggestion

This will be fullfilled by [python-prompt-toolkit](https://github.com/jonathanslenders/python-prompt-toolkit)

- History (http://python-prompt-toolkit.readthedocs.io/en/stable/pages/building_prompts.html#history)
- Auto Suggestion (http://python-prompt-toolkit.readthedocs.io/en/stable/pages/building_prompts.html#auto-suggestion)